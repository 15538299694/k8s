(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{235:function(e,t,s){"use strict";s.r(t);var r=s(0),o=Object(r.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"volume基础应用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#volume基础应用"}},[e._v("#")]),e._v(" Volume基础应用")]),e._v(" "),s("ul",[s("li",[e._v("Volume定义")]),e._v(" "),s("li",[e._v("Volume分类")]),e._v(" "),s("li",[e._v("PV的生命周期")]),e._v(" "),s("li",[e._v("pv的回收策略")]),e._v(" "),s("li",[e._v("PV的申明类型")]),e._v(" "),s("li",[e._v("额外补充")]),e._v(" "),s("li",[e._v("查询命令")]),e._v(" "),s("li",[e._v("官方文档")])]),e._v(" "),s("h2",{attrs:{id:"_1-volume定义"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-volume定义"}},[e._v("#")]),e._v(" 1.Volume定义")]),e._v(" "),s("p",[e._v("在容器的生命周期里，位于磁盘上的文件，它的生命周期是很短暂的，"),s("code",[e._v("docker")]),e._v("里面如此，"),s("code",[e._v("kubernetes")]),e._v("里亦然。\n数据很可能因为各种不可抗因素丢失，比如"),s("code",[e._v("pod")]),e._v("被迫下线时，它会根据"),s("code",[e._v("rs")]),e._v("控制器的数量定义，重新生成一个干净状态的新"),s("code",[e._v("pod")]),e._v("。\n"),s("code",[e._v("Volume")]),e._v("的引入不但解决里数据稳定性的问题，也解决了同一个"),s("code",[e._v("pod")]),e._v("内，多个"),s("code",[e._v("containers")]),e._v("数据共享的需求；和"),s("code",[e._v("docker")]),e._v("里不同的是，"),s("code",[e._v("kubernetes")]),e._v("中内置封装了很多存储类型，"),s("code",[e._v("pod")]),e._v("也可以选择性的使用一个或多个。")]),e._v(" "),s("h2",{attrs:{id:"_2-volume分类"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-volume分类"}},[e._v("#")]),e._v(" 2.Volume分类")]),e._v(" "),s("p",[s("code",[e._v("kubernetes")]),e._v("内置封装了很多存储类型，大致可分为以下七大部分：")]),e._v(" "),s("blockquote",[s("p",[e._v("我已经整理好了官方配置文档，大家可以直接按需阅读，如何使用和配置。")])]),e._v(" "),s("table",[s("thead",[s("tr",[s("th",[e._v("存储类型")]),e._v(" "),s("th",[e._v("存储组件")]),e._v(" "),s("th",[e._v("官网文档")])])]),e._v(" "),s("tbody",[s("tr",[s("td",[e._v("云存储")]),e._v(" "),s("td",[e._v("awsElasticBlockStore")]),e._v(" "),s("td",[s("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/volumes/#awselasticblockstore",target:"_blank",rel:"noopener noreferrer"}},[e._v("awsElasticBlockStore"),s("OutboundLink")],1)])]),e._v(" "),s("tr",[s("td",[e._v("云存储")]),e._v(" "),s("td",[e._v("azureDisk")]),e._v(" "),s("td",[s("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/volumes/#azuredisk",target:"_blank",rel:"noopener noreferrer"}},[e._v("azureDisk"),s("OutboundLink")],1)])]),e._v(" "),s("tr",[s("td",[e._v("云存储")]),e._v(" "),s("td",[e._v("azureFile")]),e._v(" "),s("td",[s("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/volumes/#azurefile",target:"_blank",rel:"noopener noreferrer"}},[e._v("azureFile"),s("OutboundLink")],1)])]),e._v(" "),s("tr",[s("td",[e._v("云存储")]),e._v(" "),s("td",[e._v("gcePersistentDisk")]),e._v(" "),s("td",[s("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/volumes/#gcepersistentdisk",target:"_blank",rel:"noopener noreferrer"}},[e._v("gcePersistentDisk"),s("OutboundLink")],1)])]),e._v(" "),s("tr",[s("td",[e._v("云存储")]),e._v(" "),s("td",[e._v("vsphereVolume")]),e._v(" "),s("td",[s("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/volumes/#vspherevolume",target:"_blank",rel:"noopener noreferrer"}},[e._v("vsphereVolume"),s("OutboundLink")],1)])]),e._v(" "),s("tr",[s("td",[e._v("分布式存储")]),e._v(" "),s("td",[e._v("cephfs")]),e._v(" "),s("td",[s("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/volumes/#cephfs",target:"_blank",rel:"noopener noreferrer"}},[e._v("cephfs"),s("OutboundLink")],1)])]),e._v(" "),s("tr",[s("td",[e._v("分布式存储")]),e._v(" "),s("td",[e._v("glusterfs")]),e._v(" "),s("td",[s("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/volumes/#glusterfs",target:"_blank",rel:"noopener noreferrer"}},[e._v("glusterfs"),s("OutboundLink")],1)])]),e._v(" "),s("tr",[s("td",[e._v("分布式存储")]),e._v(" "),s("td",[e._v("rbd")]),e._v(" "),s("td",[s("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/volumes/#rbd",target:"_blank",rel:"noopener noreferrer"}},[e._v("rbd"),s("OutboundLink")],1)])]),e._v(" "),s("tr",[s("td",[e._v("网络存储")]),e._v(" "),s("td",[e._v("nfs")]),e._v(" "),s("td",[s("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/volumes/#nfs",target:"_blank",rel:"noopener noreferrer"}},[e._v("nfs"),s("OutboundLink")],1)])]),e._v(" "),s("tr",[s("td",[e._v("网络存储")]),e._v(" "),s("td",[e._v("fc")]),e._v(" "),s("td",[s("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/volumes/#fc",target:"_blank",rel:"noopener noreferrer"}},[e._v("fc"),s("OutboundLink")],1)])]),e._v(" "),s("tr",[s("td",[e._v("网络存储")]),e._v(" "),s("td",[e._v("iscsi")]),e._v(" "),s("td",[s("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/volumes/#iscsi",target:"_blank",rel:"noopener noreferrer"}},[e._v("iscsi"),s("OutboundLink")],1)])]),e._v(" "),s("tr",[s("td",[e._v("临时存储")]),e._v(" "),s("td",[e._v("emptyDir")]),e._v(" "),s("td",[s("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/volumes/#emptydir",target:"_blank",rel:"noopener noreferrer"}},[e._v("emptyDir"),s("OutboundLink")],1)])]),e._v(" "),s("tr",[s("td",[e._v("本地存储")]),e._v(" "),s("td",[e._v("hostPath")]),e._v(" "),s("td",[s("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/volumes/#hostpath",target:"_blank",rel:"noopener noreferrer"}},[e._v("hostPath"),s("OutboundLink")],1)])]),e._v(" "),s("tr",[s("td",[e._v("特殊存储")]),e._v(" "),s("td",[e._v("configMap")]),e._v(" "),s("td",[s("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/volumes/#configmap",target:"_blank",rel:"noopener noreferrer"}},[e._v("configMap"),s("OutboundLink")],1)])]),e._v(" "),s("tr",[s("td",[e._v("特殊存储")]),e._v(" "),s("td",[e._v("downwardAPI")]),e._v(" "),s("td",[s("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/volumes/#downwardapi",target:"_blank",rel:"noopener noreferrer"}},[e._v("downwardAPI"),s("OutboundLink")],1)])]),e._v(" "),s("tr",[s("td",[e._v("特殊存储")]),e._v(" "),s("td",[e._v("secret")]),e._v(" "),s("td",[s("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/volumes/#secret",target:"_blank",rel:"noopener noreferrer"}},[e._v("secret"),s("OutboundLink")],1)])]),e._v(" "),s("tr",[s("td",[e._v("自定义存储")]),e._v(" "),s("td",[e._v("csi")]),e._v(" "),s("td",[s("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/volumes/#csi",target:"_blank",rel:"noopener noreferrer"}},[e._v("csi"),s("OutboundLink")],1)])]),e._v(" "),s("tr",[s("td",[e._v("持久卷申请")]),e._v(" "),s("td",[e._v("persistentVolumeClaim")]),e._v(" "),s("td",[s("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/volumes/#persistentvolumeclaim",target:"_blank",rel:"noopener noreferrer"}},[e._v("persistentVolumeClaim"),s("OutboundLink")],1)])])])]),e._v(" "),s("h2",{attrs:{id:"_3-pv的生命周期"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-pv的生命周期"}},[e._v("#")]),e._v(" 3.PV的生命周期")]),e._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("   Provisioning：            申明\n   Binding：                 绑定\n   using：                   使用     \n   Reclaiming：              回收\n")])])]),s("h2",{attrs:{id:"_4-pv的回收策略"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-pv的回收策略"}},[e._v("#")]),e._v(" 4.PV的回收策略")]),e._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("    Delete：     数据和pv都会删除\n    Recyle：     （已废弃）\n    Retain：     数据和pv都不动\n")])])]),s("h2",{attrs:{id:"_5-pv的申明类型"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-pv的申明类型"}},[e._v("#")]),e._v(" 5.PV的申明类型")]),e._v(" "),s("p",[s("code",[e._v("PV")]),e._v("的申明是建立在"),s("code",[e._v("SC")]),e._v("（"),s("code",[e._v("StorageClasses")]),e._v("：存储类）上的，可分为以下两种：")]),e._v(" "),s("p",[e._v("Static：")]),e._v(" "),s("blockquote",[s("p",[e._v("静态，管理员分配")])]),e._v(" "),s("p",[e._v("Dynamic：")]),e._v(" "),s("blockquote",[s("p",[e._v("动态，API server需要增加一个参数配置。--enable-admission-plugins，具体类型参考:\n"),s("a",{attrs:{href:"https://kubernetes.io/docs/concepts/storage/storage-classes/",target:"_blank",rel:"noopener noreferrer"}},[e._v("storage-classes"),s("OutboundLink")],1)])]),e._v(" "),s("h2",{attrs:{id:"_6-额外补充"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-额外补充"}},[e._v("#")]),e._v(" 6.额外补充")]),e._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("    1.Pv没有namespace,Pvc有namespace\n    2.SC（存储类）的API字段配置说明：kubectl explain sc\n")])])]),s("h2",{attrs:{id:"_7-查询命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-查询命令"}},[e._v("#")]),e._v(" 7.查询命令")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#API字段配置说明")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("root@centos-1 mainfasts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# kubectl explain pods.spec.volumes")]),e._v("\nKIND:     Pod\nVERSION:  v1\nRESOURCE: volumes "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("Object"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#API字段配置说明      ")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("root@centos-1 dingqishi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# kubectl explain pods.spec.volumes.persistentVolumeClaim")]),e._v("\nKIND:     Pod\nVERSION:  v1\nRESOURCE: persistentVolumeClaim "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("Object"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#集群pv情况查看")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("root@centos-1 dingqishi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#kubectl get pv -A")]),e._v("\n")])])]),s("h2",{attrs:{id:"_8-官方文档"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-官方文档"}},[e._v("#")]),e._v(" 8.官方文档")]),e._v(" "),s("p",[e._v("https://kubernetes.io/docs/concepts/storage/volumes/")]),e._v(" "),s("p",[e._v("https://kubernetes.io/docs/concepts/storage/persistent-volumes/")])])}),[],!1,null,null,null);t.default=o.exports}}]);